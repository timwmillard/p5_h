# CLAUDE.md

This file provides guidance to Claude Code (claude.ai/code) when working with code in this repository.

## Build Commands

- `make` - Build the project (compiles deps and main executable)
- `make demo` - Build the main demo executable
- `make shader` - Regenerate shader header from GLSL source using sokol-shdc
- `make run` - Build and run the demo application
- `make sokol` - Download latest Sokol headers from GitHub
- `make clean` - Clean build artifacts

## Architecture Overview

This is a 3D graphics demo application built with the Sokol graphics framework. The application renders a simple colored triangle using modern graphics APIs.

### Core Components

- **Main Application** (`src/main.c`): Uses `sokol_main()` entry point, sets up a 640x480 window, creates vertex buffers with position/color data, and implements the main rendering loop
- **Shader System**: 
  - `src/shader.glsl` contains cross-platform shader source with Sokol syntax
  - `src/shader_glsl.h` is auto-generated by sokol-shdc with compiled bytecode for multiple graphics backends (GLSL 4.30, HLSL 5.0, Metal)
- **Dependencies** (`deps/`): Contains Sokol single-header libraries (sokol_app.h, sokol_gfx.h, sokol_glue.h)

### Graphics Pipeline

The application uses a modern programmable graphics pipeline:
1. Vertex buffer creation with position and color attributes
2. Shader program binding (vertex shader transforms positions, fragment shader outputs colors)
3. Render pass setup with clear color
4. Triangle rendering in continuous frame loop

### Platform Configuration

Currently configured for macOS Metal backend:
- Uses `-DSOKOL_METAL` flag and Metal frameworks (Cocoa, QuartzCore, Metal, MetalKit)
- Supports cross-platform compilation by changing backend flags
- Shader compilation targets multiple backends simultaneously

### Shader Workflow

When modifying shaders:
1. Edit `src/shader.glsl` using Sokol's @vs/@fs/@program syntax
2. Run `make shader` to regenerate the header file
3. Rebuild with `make` to incorporate changes
